---
title: "Data Exploration and Preparation (CA Group)"
output: html_notebook
---

Students:\
Fernando\
Mark

Dataset Source: https://archive.ics.uci.edu/ml/datasets/Diabetes+130-US+hospitals+for+years+1999-2008#

#### Citations:

Beata Strack, Jonathan P. DeShazo, Chris Gennings, Juan L. Olmo, Sebastian Ventura, Krzysztof J. Cios, and John N. Clore, “Impact of HbA1c Measurement on Hospital Readmission Rates: Analysis of 70,000 Clinical Database Patient Records,” BioMed Research International, vol. 2014, Article ID 781670, 11 pages, 2014.

---

#### Data Set Information:

The dataset represents 10 years (1999-2008) of clinical care at 130 US hospitals and integrated delivery networks. It includes over 50 features representing patient and hospital outcomes. Information was extracted from the database for encounters that satisfied the following criteria.

1. It is an inpatient encounter (a hospital admission).
2. It is a diabetic encounter, that is, one during which any kind of diabetes was entered to the system as a diagnosis.
3. The length of stay was at least 1 day and at most 14 days.
4. Laboratory tests were performed during the encounter.
5. Medications were administered during the encounter.

The data contains such attributes as patient number, race, gender, age, admission type, time in hospital, medical specialty of admitting physician, number of lab test performed, HbA1c test result, diagnosis, number of medication, diabetic medications, number of outpatient, inpatient, and emergency visits in the year before the hospitalization, etc.

#### Attribute Information:

Detailed description of all the atrributes is provided in Table 1 Beata Strack, Jonathan P. DeShazo, Chris Gennings, Juan L. Olmo, Sebastian Ventura, Krzysztof J. Cios, and John N. Clore, “Impact of HbA1c Measurement on Hospital Readmission Rates: Analysis of 70,000 Clinical Database Patient Records,” BioMed Research International, vol. 2014, Article ID 781670, 11 pages, 2014

https://www.hindawi.com/journals/bmri/2014/781670/

#### Import Datasets

```{r}
df <- read.csv('diabetic_data.csv')
id <- read.csv('IDs_mapping.csv')
```

Let's take a look on what is inside the datasets

```{r}
str(df)
```

The diabetes dataframe (df) contains 101766 observations of  50 variables

```{r}
str(id)
```

The id dataframe contains 67 observations of 2 variables

```{r}
head(df)
head(id)
```

---
## Assessment Tasks

#### a) Identify which variables are categorical, discrete and continuous in the chosen data set and show using some visualization or plot. Explore whether there are missing values for any of the variables.

First let's take a closer look at the id dataframe

```{r}
id
```

As we can see, the ID variables are interchanged to all other ids and we can possibly use only one id variable and change the description variable to their appropriate type

#### Clean up id dataframe

First let's find out what is the maximum number(id) from the id dataframe

```{r}
num_only_temp <- as.numeric(id$admission_type_id)
max(na.omit(num_only_temp))
```

Transform dataframe to use only one id variable

method:

1. create an new dataframe (id_clean) to push data to as we clean up the id dataframe
2. create id variable using the max value obtained from the previous code block
3. clean up admission_type, discharge_disposition, admission_source variables and pad the empty cells with NA

```{r}
# create new dataframe to push cleaned data to
id_clean <- data.frame(id = 1:30)

# admission_type variable
admission_type <- rep(NA, each = 30)
admission_type[1:8] <- id[1:8, 2]
id_clean$admission_type <- admission_type

# discharge_disposition variable
discharge_disposition <- rep(NA, each = 30)
discharge_disposition[1:26] <- id[11:36, 2]
discharge_disposition[27:29] <- id[38:40, 2]
discharge_disposition[30] <- id[37, 2]
id_clean$discharge_disposition <- discharge_disposition

admission_source <- rep(NA, each = 30)
admission_source[1:15] <- id[43:57, 2]
admission_source[17:26] <- id[58:67, 2]
id_clean$admission_source <- admission_source
```

```{r}
id_clean
```

All of the variables are categorical variables excluding the id which is sequential and is used to reference values from df dataframe

Some values are missing and some use different terms like: Not Available, NA, NULL, Not Mapped, Unknown/Invalid

#### Next let's take a look at the diabetes(df) dataframe

```{r}
df
```

It seems that the diabetes(df) dataframe uses ? as NA but we will check NA values anyway just to make sure

```{r}
na_count <- sapply(df, function(y) sum(length(which(is.na(y)))))
na_count
```

There is no NA values in the dataframe as expected

```{r}
na_count_question <- sapply(df, function(y) sum(length(which(y == '?'))))
na_count_question
```

As we can see, columns weight, medical_specialty and payer_code has a lot of missing values so it is safe to omit those columns as they wouldn't helpful for the analysis

```{r}
df
```

identifiers: encounter_id, patient_nbr

categorical: race, gender, admission_type_id, discharge_position_id, admission_source_id, medical specialty, max_glu_serum, A1Cresult, metformin, repaglinide, nateglinide, chlorpropamide, glimepiride, acetohexamide, glipizide, glyburide, tolbutamide, pioglitazone, rosiglitazone, acarbose, miglitol, troglitazone, tolazamide, examide, citoglipton, insulin, glyburide.metformin, glipizide.metformin, glimepiride.pioglitazone, metformin.rosiglitazone, metformin.pioglitazone, change, diabetesMed, readmitted

admission_type_id, discharge_position_id, admission_source_id references values to id dataframe so it is treated as a categorical data

discrete: age, time_in_hospital, num_lab_procedures, num_procedures, num_medications, number_outpatient, ,number_emergency,number_inpatient, diag_1, diag_2, diag_3, number_diagnoses

age in medical data is treated as discrete data

continuous: 

unfortunately, we didn't find any variable that has continuous data

```{r}

```

